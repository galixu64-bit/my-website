// 多语言翻译文件
const translations = {
    zh: {
        // 通用
        'login': '登录',
        'logout': '登出',
        'register': '注册',
        'cancel': '取消',
        'submit': '提交',
        'save': '保存',
        'delete': '删除',
        'edit': '编辑',
        'back': '返回',
        'search': '搜索',
        'filter': '筛选',
        'reset': '重置',
        'confirm': '确认',
        'close': '关闭',
        'loading': '加载中...',
        'error': '错误',
        'success': '成功',
        
        // 导航和页面
        'siteName': 'dragbit',
        'siteDescription': '优质资源，免费下载',
        'home': '首页',
        'myResources': '我的资源',
        'addResource': '添加资源',
        'profile': '个人中心',
        'loginRequired': '需要登录',
        'loginRequiredMessage': '您需要登录才能查看资源\n请登录或注册',
        
        // 资源相关
        'resources': '资源',
        'allCategories': '全部',
        'software': '软件',
        'document': '文档',
        'media': '媒体',
        'website': '网站',
        'other': '其他',
        'searchPlaceholder': '搜索资源...',
        'addResourceButton': '+ 添加资源',
        'visitWebsite': '访问网站',
        'download': '下载',
        'viewDetails': '查看详情',
        'comments': '评论',
        'uploadedBy': '发布者',
        'uploadedAt': '发布时间',
        'tags': '标签',
        'category': '分类',
        'description': '描述',
        'author': '作者',
        'noCommentsYet': '暂无评论，快来发表第一条评论吧！',
        'loginToComment': '请登录后评论',
        
        // 登录页面
        'loginTitle': '登录资源库',
        'loginSubtitle': '账号登录，畅享高质量资源免费下载！',
        'username': '用户名',
        'password': '密码',
        'loginButton': '登录',
        'registerButton': '注册',
        'demoAccount': '演示账号：',
        'or': '或',
        
        // 注册页面
        'registerTitle': '✨ 注册',
        'registerSubtitle': '创建账户开始使用',
        'confirmPassword': '确认密码',
        'email': '邮箱',
        'verificationCode': '验证码',
        'sendCode': '发送验证码',
        'codeSentTo': '验证码将发送到此邮箱',
        'registerSubmit': '注册',
        'alreadyHaveAccount': '已有账户？',
        'loginNow': '立即登录',
        'backToHome': '← 返回首页',
        'enterCode': '请输入验证码',
        
        // 我的资源页面
        'myResourcesTitle': '我的资源',
        'myResourcesSubtitle': '这里展示你在dragbit上传的所有资源',
        'noMyResources': '你还没有上传任何资源',
        'addFirstResource': '添加第一个资源',
        'backToMain': '返回主页',
        
        // 添加资源页面
        'addResourceTitle': '➕ 添加资源',
        'addResourceSubtitle': '资源将收录在 dragbit —— 一个优质资源网站',
        'addNewResource': '添加新资源',
        'resourceName': '资源名称',
        'resourceDescription': '资源描述',
        'resourceDetails': '详细说明',
        'resourceTags': '标签（用逗号分隔）',
        'exampleTags': '例如：免费,开源,Windows,中文',
        'tagsHelp': '输入多个标签，用逗号分隔，例如：免费,开源,Windows',
        'displayImage': '展示图片URL',
        'displayVideo': '展示视频URL',
        'displayImagePlaceholder': '输入图片URL（可选）',
        'displayVideoPlaceholder': '输入视频URL（可选）',
        'imageHelp': '支持 jpg, png, gif 格式',
        'videoHelp': '支持 YouTube, Bilibili, 或其他视频链接',
        'resourceLink': '资源链接',
        'resourceLinkPlaceholder': 'https://example.com 或 file:///path/to/file',
        'resourceLinkHelp': '网站链接或本地文件路径',
        'categorySelect': '分类',
        'iconSelect': '图标',
        'submitResource': '提交',
        'backToDragbit': '← 返回 dragbit',
        
        // 个人中心页面
        'profileTitle': '个人中心',
        'profileSubtitle': '管理你的账户信息',
        'member': '会员',
        'totalResources': '总资源数',
        'totalComments': '总评论数',
        'accountInfo': '账户信息',
        'changeAvatar': '更换头像',
        'accountSettings': '账户设置',
        'changePassword': '修改密码',
        'newPassword': '新密码',
        'confirmNewPassword': '确认新密码',
        
        // Other
        'copyright': '© 2024 dragbit | Made with ❤️',
    },
    en: {
        // Common
        'login': 'Login',
        'logout': 'Logout',
        'register': 'Register',
        'cancel': 'Cancel',
        'submit': 'Submit',
        'save': 'Save',
        'delete': 'Delete',
        'edit': 'Edit',
        'back': 'Back',
        'search': 'Search',
        'filter': 'Filter',
        'reset': 'Reset',
        'confirm': 'Confirm',
        'close': 'Close',
        'loading': 'Loading...',
        'error': 'Error',
        'success': 'Success',
        
        // Navigation and Pages
        'siteName': 'dragbit',
        'siteDescription': 'High-quality resources, free download',
        'home': 'Home',
        'myResources': 'My Resources',
        'addResource': 'Add Resource',
        'profile': 'Profile',
        'loginRequired': 'Login Required',
        'loginRequiredMessage': 'You need to login to view resources\nPlease login or register',
        
        // Resources
        'resources': 'Resources',
        'allCategories': 'All',
        'software': 'Software',
        'document': 'Document',
        'media': 'Media',
        'website': 'Website',
        'other': 'Other',
        'searchPlaceholder': 'Search resources...',
        'addResourceButton': '+ Add Resource',
        'visitWebsite': 'Visit Website',
        'download': 'Download',
        'viewDetails': 'View Details',
        'comments': 'Comments',
        'uploadedBy': 'Uploaded By',
        'uploadedAt': 'Uploaded At',
        'tags': 'Tags',
        'category': 'Category',
        'description': 'Description',
        'author': 'Author',
        'noCommentsYet': 'No comments yet. Be the first to comment!',
        'loginToComment': 'Please login to comment',
        
        // Login Page
        'loginTitle': 'Login',
        'loginSubtitle': 'Account login to enjoy high-quality free resources!',
        'username': 'Username',
        'password': 'Password',
        'loginButton': 'Login',
        'registerButton': 'Register',
        'demoAccount': 'Demo Account:',
        'or': 'or',
        
        // Register Page
        'registerTitle': '✨ Register',
        'registerSubtitle': 'Create an account to get started',
        'confirmPassword': 'Confirm Password',
        'email': 'Email',
        'verificationCode': 'Verification Code',
        'sendCode': 'Send Code',
        'codeSentTo': 'Verification code will be sent to this email',
        'registerSubmit': 'Register',
        'alreadyHaveAccount': 'Already have an account?',
        'loginNow': 'Login Now',
        'backToHome': '← Back to Home',
        'enterCode': 'Enter verification code',
        
        // My Resources Page
        'myResourcesTitle': 'My Resources',
        'myResourcesSubtitle': 'All resources you uploaded on dragbit',
        'noMyResources': 'You have not uploaded any resources yet',
        'addFirstResource': 'Add Your First Resource',
        'backToMain': 'Back to Home',
        
        // Add Resource Page
        'addResourceTitle': '➕ Add Resource',
        'addResourceSubtitle': 'Resources will be added to dragbit - a quality resource website',
        'addNewResource': 'Add New Resource',
        'resourceName': 'Resource Name',
        'resourceDescription': 'Resource Description',
        'resourceDetails': 'Details',
        'resourceTags': 'Tags (comma separated)',
        'exampleTags': 'Example: Free,Open Source,Windows,Chinese',
        'tagsHelp': 'Enter multiple tags separated by commas, e.g.: Free,Open Source,Windows',
        'displayImage': 'Display Image URL',
        'displayVideo': 'Display Video URL',
        'displayImagePlaceholder': 'Enter image URL (optional)',
        'displayVideoPlaceholder': 'Enter video URL (optional)',
        'imageHelp': 'Supports jpg, png, gif formats',
        'videoHelp': 'Supports YouTube, Bilibili, or other video links',
        'resourceLink': 'Resource Link',
        'resourceLinkPlaceholder': 'https://example.com or file:///path/to/file',
        'resourceLinkHelp': 'Website link or local file path',
        'categorySelect': 'Category',
        'iconSelect': 'Icon',
        'submitResource': 'Submit',
        'backToDragbit': '← Back to dragbit',
        
        // Profile Page
        'profileTitle': 'Profile',
        'profileSubtitle': 'Manage your account information',
        'member': 'Member',
        'totalResources': 'Total Resources',
        'totalComments': 'Total Comments',
        'accountInfo': 'Account Information',
        'changeAvatar': 'Change Avatar',
        'accountSettings': 'Account Settings',
        'changePassword': 'Change Password',
        'newPassword': 'New Password',
        'confirmNewPassword': 'Confirm New Password',
        
        // Other
        'copyright': '© 2024 dragbit | Made with ❤️',
    }
};

// 语言工具对象
(function() {
    'use strict';
    
    // 获取当前语言
    let currentLang = 'zh';
    try {
        currentLang = localStorage.getItem('language') || 'zh';
        if (!translations[currentLang]) {
            currentLang = 'zh';
        }
    } catch (e) {
        currentLang = 'zh';
    }
    
    // 创建 i18n 对象
    const i18n = {
        currentLang: currentLang,
        
        setLanguage: function(lang) {
            if (translations[lang]) {
                this.currentLang = lang;
                try {
                    localStorage.setItem('language', lang);
                } catch (e) {
                    // 忽略 localStorage 错误
                }
                this.updatePage();
            }
        },
        
        t: function(key) {
            return translations[this.currentLang] && translations[this.currentLang][key] 
                || translations['zh'][key] 
                || key;
        },
        
        updatePage: function() {
            // 更新 data-i18n
            document.querySelectorAll('[data-i18n]').forEach(function(el) {
                const key = el.getAttribute('data-i18n');
                if (key) {
                    el.textContent = i18n.t(key);
                }
            });
            
            // 更新 data-i18n-placeholder
            document.querySelectorAll('[data-i18n-placeholder]').forEach(function(el) {
                const key = el.getAttribute('data-i18n-placeholder');
                if (key) {
                    el.placeholder = i18n.t(key);
                }
            });
            
            // 更新 data-i18n-title
            document.querySelectorAll('[data-i18n-title]').forEach(function(el) {
                const key = el.getAttribute('data-i18n-title');
                if (key) {
                    el.title = i18n.t(key);
                }
            });
            
            // 更新 HTML lang 属性
            if (document.documentElement) {
                document.documentElement.lang = this.currentLang === 'zh' ? 'zh-CN' : 'en';
            }
            
            // 触发语言变更事件
            try {
                window.dispatchEvent(new CustomEvent('languageChanged', { 
                    detail: { lang: this.currentLang } 
                }));
            } catch (e) {
                // 忽略事件分发错误
            }
        },
        
        init: function() {
            this.updatePage();
        }
    };
    
    // 导出到全局
    window.i18n = i18n;
    window.translations = translations;
    
    console.log('✓ i18n 已加载，当前语言:', currentLang);
})();
